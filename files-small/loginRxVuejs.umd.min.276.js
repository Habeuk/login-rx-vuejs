"use strict";(("undefined"!==typeof self?self:this)["webpackChunkloginRxVuejs"]=("undefined"!==typeof self?self:this)["webpackChunkloginRxVuejs"]||[]).push([[276],{6276:(e,t,n)=>{n.r(t),n.d(t,{default:()=>z});var o=function(){var e=this,t=e._self._c;return t("div",{staticClass:"buttton-google-aouth",class:e.classRender,attrs:{id:e.idHtmlrender,client_google_is_define:e.client_google_is_define}})},r=[],s=n(8123);n(6099),n(3362);const i={userAccess:{},client_id:"513247959752-qapd9jb30pdtoh51m0h53070a2v8c4er.apps.googleusercontent.com"};var a=n(9199),u=n(5207),l=(n(4423),n(1699),function(){var e=this,t=e._self._c;return t("div",[t("b-button",{attrs:{variant:"outline-success",size:"sm"},on:{click:e.onSubmit}},[t("span",[e._v(e._s(e.texte))]),e.running?t("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)}),c=[];const d={name:"ButtonSave",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Enregistrer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{onSubmit:function(){this.$emit("ev-click")}}},g=d;var h=n(1656),f=(0,h.A)(g,l,c,!1,null,"29246a2e",null);f.exports;var p=function(){var e=this,t=e._self._c;return t("div",[t("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:e.DeleteFile}},[t("span",[e._v(" "+e._s(e.texte)+" ")]),e.running?t("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)},m=[];const v={name:"ButtonDelete",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Supprimer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{DeleteFile:function(){this.$emit("ev-click")}}},w=v;var x=(0,h.A)(w,p,m,!1,null,"0b82f270",null);x.exports;n(6918),n(8598),n(739),n(3288),n(2010),n(3110),n(9432),n(2762),n(2207),n(5815),n(4979),n(9739);var _=n(2465),T=_.A.create({timeout:3e5});T.interceptors.request.use((function(e){return e.headers["request-startTime"]=(new Date).getTime(),e})),T.interceptors.response.use((function(e){var t=(new Date).getTime(),n=e.config.headers["request-startTime"],o=t-n;return o&&(o/=1e3),e.headers["request-duration"]=o,e}));var b,k=function(e,t){var n=e+":"+t,o=btoa(n);return"Basic "+o},A=JSON.parse(window.localStorage.getItem("user"));b=window.localStorage.getItem("current_user")?JSON.parse(window.localStorage.getItem("current_user")):null;var S={auth:A?k(A.username,A.password):null,current_user:b,axiosInstance:T,TestDomain:null,baseUrl:null,languageId:null,debug:!1,isLocalDev:!(!window.location.host.includes("localhost")&&!window.location.host.includes(".kksa")),customHeaders:{},getBaseUrl:function(){return this.baseUrl?this.isLocalDev&&this.TestDomain?this.TestDomain.trim("/"):this.baseUrl:this.isLocalDev&&this.TestDomain?this.TestDomain.trim("/"):window.location.protocol+"//"+window.location.host},getStatusText:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?t?e?e.response&&e.headers.customstatustext?e.headers.customstatustext:void 0:e.statusText?e.statusText:null:e.response&&e.response.headers&&e.response.headers.customstatustext?e.response.headers.customstatustext:e.response&&e.response.statusText?e.response.statusText:null:null},post:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r,s){""===n.languageId||void 0===n.languageId||null===n.languageId||e.includes("://")||(e="/"+n.languageId+e);var i=e.includes("://")?e:n.getBaseUrl()+e;o=n.mergeCustomHeaders(o),T.post(i,t,o).then((function(e){n.debug&&console.log("Debug axio : \n",i,"\n payload: ",t,"\n config: ",o,"\n Duration : ",e.headers["request-duration"],"\n reponse: ",e,"\n ------ \n"),r({status:!0,data:e.data,reponse:e,statusText:n.getStatusText(e,!0)})}))["catch"]((function(e){console.log("error wbutilities",e.response),s({status:!1,error:e.response,code:e.code,stack:e.stack,statusText:n.getStatusText(e)})}))}))},delete:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(r,s){var i=e.includes("://")?e:n.getBaseUrl()+e;o=n.mergeCustomHeaders(o),T["delete"](i,o,t).then((function(e){r({status:!0,data:e.data,reponse:e,statusText:n.getStatusText(e,!0)})}))["catch"]((function(e){s({status:!1,error:e.response,code:e.code,stack:e.stack,statusText:n.getStatusText(e)})}))}))},get:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(o,r){""===t.languageId||void 0===t.languageId||null===t.languageId||e.includes("://")||(e="/"+t.languageId+e);var s=e.includes("://")?e:t.getBaseUrl()+e;n=t.mergeCustomHeaders(n),T.get(s,n).then((function(e){t.debug&&console.log("Debug axio : \n",s,"\n Config: ",n,"\n Duration : ",e.headers["request-duration"],"\n Reponse: ",e,"\n ------ \n"),o({status:!0,data:e.data,reponse:e,statusText:t.getStatusText(e,!0)})}))["catch"]((function(e){r({status:!1,error:e.response,code:e.code,stack:e.stack,statusText:t.getStatusText(e)})}))}))},postFile:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(r,s){n.getBase64(t).then((function(i){var a=new Headers,u=t.name.split("."),l={method:"POST",headers:a,body:JSON.stringify({upload:i.base64,ext:u.pop(),filename:u.join("."),id:o}),cache:"default"},c=e.includes("://")?e:n.getBaseUrl()+e;fetch(c,l).then((function(e){e.json().then((function(e){r(e)}))["catch"]((function(e){s(e)}))}))}))}))},getBase64:function(e){return new Promise((function(t,n){var o=new FileReader;o.readAsDataURL(e),o.onloadend=function(){var e=o.result.split(",");t({src:o.result,base64:e[1]})},o.onerror=function(e){return n(e)}}))},setHeaders:function(e,t){this.customHeaders[e]=t},mergeCustomHeaders:function(e){if(e.headers||(e.headers={}),this.customHeaders)for(var t in this.customHeaders)e.headers[t]=this.customHeaders[t];return e}};const I=S;var y=n(9274),C=n.n(y),D=n(7918),B=n(2788);C().use(D.F),C().use(B.l);var H=new(C());(0,s.A)((0,s.A)({},I),{},{$bvToast:H.$bvToast,$bvModal:H.$bvModal,modalMessage:function(e,t){var n=this,o={size:"md",buttonSize:"sm",hideFooter:!0,centered:!0};for(var r in t)o[r]=t[r];return new Promise((function(t,r){n.$bvModal.msgBoxConfirm(e,o).then((function(e){console.log("value : ",e),t(e)}))["catch"]((function(e){r(e)}))}))},modalConfirmDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Confirmer la suppression, NB : cette action est irreverssible.",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={title:"Attention",okVariant:"danger",okTitle:"Supprimer",cancelTitle:"Annuler",footerClass:"p-2",headerBgVariant:"danger",headerTextVariant:"light"};for(var o in t)n[o]=t[o];return this.modalMessage(e,n)},modalSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={title:"Succes",headerBgVariant:"success",bodyClass:["p-3"],hideFooter:!0,headerTextVariant:"light"};for(var o in t)n[o]=t[o];return this.modalMessage(e,n)},notification:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";this.$bvToast.toast(" ",{title:e,variant:t,solid:!0,toaster:"b-toaster-top-right"})},bPost:function(e,t,n){var o=this,r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"success",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"warning";return new Promise((function(a,u){o.post(e,t,n).then((function(e){r&&o.notification(s),a(e)}))["catch"]((function(e){o.notification(o.GetErrorTitle(e),i),u(e)}))}))},bGet:function(e,t){var n=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"success",s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"warning";return new Promise((function(i,a){n.get(e,t).then((function(e){o&&n.notification(r),i(e)}))["catch"]((function(e){n.notification(n.GetErrorTitle(e),s),a(e)}))}))},GetErrorTitle:function(e){var t;if(e.code)switch(e.code){case"ECONNABORTED":var n=this.axiosInstance.defaults.timeout/1e3+"s";t="Impossible de joindre l'hote distant, temps impartie epuisé. ("+n+")";break;default:t="Une erreur s'est produite"}else e.error&&e.error.statusText&&(t=decodeURI(e.error.statusText));return t}});n(1121),n(6377),n(6028),n(7769),n(3628);var j=(0,s.A)((0,s.A)({},I),{},{languageId:window.drupalSettings&&window.drupalSettings.path&&window.drupalSettings.path.currentLanguage?window.drupalSettings.path.currentLanguage:null,TestDomain:window.location.host.includes("localhost")?"http://habeuk.kksa":window.location.protocol+"//"+window.location.host,getRandomIntInclusive:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:99,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:999;return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}});const U=j,E=(0,s.A)((0,s.A)({},U),{},{url_session:"/session/token",token:null,getToken:function(){var e=this;return new Promise((function(t){e.token&&t(e.token),e.get(e.url_session).then((function(n){e.token=n.data,t(n.data)}))}))}});var R=(0,s.A)((0,s.A)((0,s.A)({},E),U),{},{dPost:function(e,t){var n=arguments,o=this;return(0,u.A)((0,a.A)().mark((function r(){var s,i,u;return(0,a.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return s=n.length>2&&void 0!==n[2]?n[2]:null,r.next=3,o.getToken();case 3:return i=r.sent,u={"X-CSRF-Token":i,"Content-Type":"application/json"},s&&(u=o.mergeHeaders(s,u)),r.abrupt("return",o.post(e,t,{headers:u}));case 7:case"end":return r.stop()}}),r)})))()},dGet:function(e){var t=arguments,n=this;return(0,u.A)((0,a.A)().mark((function o(){var r,s,i;return(0,a.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:null,o.next=3,n.getToken();case 3:return s=o.sent,i={"X-CSRF-Token":s,"Content-Type":"application/json"},r&&(i=n.mergeHeaders(r,i)),o.abrupt("return",n.get(e,{headers:i}));case 7:case"end":return o.stop()}}),o)})))()},mergeHeaders:function(e,t){if(e)for(var n in e)t[n]=e[n];return t}});const F=R,P={AfterRedirect:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"reload",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("AfterRedirect action .",e);var o=null;if("redirect"==e&&t);else if("home"==e)window.location.assign("/");else if("reload"==e)window.location.reload();else if("emit_even"==e){var r=new CustomEvent("login_rx_vuejs__user_is_login");document.dispatchEvent(r)}else if("emit_even_register"==e){r=new CustomEvent("login_rx_vuejs__user_is_register");document.dispatchEvent(r)}else"default"==e&&(n.reponse&&n.reponse.config.url!==n.reponse.request.responseURL?window.location.assign(n.reponse.request.responseURL):n.data&&n.data.createuser?o="final-gl-register":n.data&&window.location.reload());return o}};var q=n(5353);function L(e){return new Promise((function(t){var n=document.createElement("script");n.setAttribute("src",e),n.onload=function(){console.log(" Chargement du script ok : ",e),t(!0)},document.head.appendChild(n)}))}const G={name:"LoginGoogle",props:{idHtml:{type:String,required:!0},returnUidInfo:{type:Boolean,default:!1},classRender:{type:Array,default:function(){return["mx-auto"]}},actionAfterLogin:{type:String,required:!0}},computed:(0,s.A)((0,s.A)({},(0,q.aH)(["configs_login_rx_vuejs"])),{},{idHtmlrender:function(){return"google-login-tab"+this.idHtml},client_google_is_define:function(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.client_google_id?(this.initGoogle(),!0):(console.log("Error de configuration de google, veillez denifir la clée 'client_google_id'"),"")}}),methods:{initGoogle:function(){var e=this;window.google?this.getUserInfoFromFrame():L("https://accounts.google.com/gsi/client").then((function(){e.getUserInfoFromFrame()}))},getUserInfoFromFrame:function(){var e=this,t=this;function n(e){i.userAccess=(0,s.A)((0,s.A)({},e),{},{client_id:e.clientId}),t.TryToLoginWithGoogle(),window.rxGoogle=i}var o=function(){var o={client_id:e.configs_login_rx_vuejs.client_google_id,callback:n},r={theme:"outline",size:"large",shape:"rectangular"};F.languageId&&(o.locale=F.languageId,r.locale=F.languageId),window.google.accounts.id.initialize(o),window.google.accounts.id.renderButton(document.getElementById(t.idHtmlrender),r),window.google.accounts.id.prompt()};o()},TryToLoginWithGoogle:function(){var e=this;return new Promise((function(t,n){F.post("/login-rx-vuejs/google-check",i.userAccess).then((function(n){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-success",e.alertText="Connexion réussie",e.$emit("ev_logingoogle",n.data),e.returnUidInfo||P.AfterRedirect(e.actionAfterLogin,null,n),t(n)}))["catch"]((function(t){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-danger",e.alertText="Google : Erreur de connexion",t.error&&t.error.statusText&&""!=t.error.statusText&&(e.alertText=t.error.statusText),console.log(" Error ajax ",t.error),console.log(" Error ajax ",t.code),console.log(" Error ajax ",t.stack),n(t)}))}))}}},M=G;var $=(0,h.A)(M,o,r,!1,null,null,null);const z=$.exports}}]);
//# sourceMappingURL=loginRxVuejs.umd.min.276.js.map