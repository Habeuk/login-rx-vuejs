(("undefined"!==typeof self?self:this)["webpackJsonploginRxVuejs"]=("undefined"!==typeof self?self:this)["webpackJsonploginRxVuejs"]||[]).push([[3],{"0d95":function(e,t,n){"use strict";n("aaa3")},1182:function(e,t,n){"use strict";n.r(t);var s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("ValidationObserver",{ref:"formValidate",attrs:{tag:"form"}},[n("div",{staticClass:"login-page"},[e.alertDisplay?n("div",{staticClass:"alert w-100",class:e.alertType,attrs:{role:"alert"},domProps:{innerHTML:e._s(e.alertText)}}):e._e(),e.isBusy?n("div",{staticClass:"spinner-grow text-primary",staticStyle:{width:"3rem",height:"3rem"},attrs:{role:"status"}},[n("span",{staticClass:"sr-only"},[e._v("Chargement ...")])]):e._e(),n("transition",{attrs:{name:"customslide"}},[n("div",{staticClass:"block-center"},[n(e.stepe,{tag:"component",attrs:{urlLogo:e.urlLogo,form:e.form,formValidate:e.formValidate,action_after_login:e.action_after_login},on:{"select-stepe":e.selectStepe}})],1)])],1),n("div",{staticClass:"text-white politik-secur mx-auto text-center"},[n("p",[e._v(" En vous inscrivant, vous acceptez nos "),n("a",{attrs:{href:"#"}},[e._v(" Conditions d'utilisation ")]),e._v(", de recevoir des emails et des MAJ de LESROISDELARENO et vous reconnaissez avoir lu notre "),n("a",{attrs:{href:"#"}},[e._v(" Politique de confidentialité")])])])])},r=[],o=n("1da1"),a=(n("96cf"),n("5530")),i=n("8bbf"),c=n.n(i),l=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-button",{attrs:{variant:"outline-success",size:"sm"},on:{click:e.onSubmit}},[n("span",[e._v(e._s(e.texte))]),e.running?n("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)},u=[],d={name:"ButtonSave",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Enregistrer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{onSubmit:function(){this.$emit("ev-click")}}},f=d,m=n("2877");function g(e){}var p=Object(m["a"])(f,l,u,!1,g,"29246a2e",null,!0),v=(p.exports,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",[n("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:e.DeleteFile}},[n("span",[e._v(" "+e._s(e.texte)+" ")]),e.running?n("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)}),h=[],w={name:"ButtonDelete",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Supprimer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{DeleteFile:function(){this.$emit("ev-click")}}},b=w;function _(e){}var k,x=Object(m["a"])(b,v,h,!1,_,"0b82f270",null,!0),C=(x.exports,n("1c24"),n("869e"),n("82e4"),n("c26d"),n("a9ce"),n("9a6c"),n("7973"),n("47d8"),n("6b54")),y=n.n(C),j=y.a.create({timeout:3e5}),T=function(e,t){var n=e+":"+t,s=btoa(n);return"Basic "+s},O=JSON.parse(window.localStorage.getItem("user"));k=window.localStorage.getItem("current_user")?JSON.parse(window.localStorage.getItem("current_user")):null;var S={auth:O?T(O.username,O.password):null,current_user:k,axiosInstance:j,TestDomain:null,baseUrl:null,isLocalDev:!(!window.location.host.includes("localhost")&&!window.location.host.includes(".kksa")),getBaseUrl:function(){return this.baseUrl?this.isLocalDev&&this.TestDomain?this.TestDomain.trim("/"):this.baseUrl:this.isLocalDev&&this.TestDomain?this.TestDomain.trim("/"):window.location.protocol+"//"+window.location.host},post:function(e,t,n){var s=this;return new Promise((function(r,o){var a=e.includes("://")?e:s.getBaseUrl()+e;j.post(a,t,n).then((function(e){r({status:!0,data:e.data,reponse:e})}))["catch"]((function(e){o({status:!1,error:e.response,code:e.code,stack:e.stack})}))}))},delete:function(e,t,n){var s=this;return new Promise((function(r,o){var a=e.includes("://")?e:s.getBaseUrl()+e;console.log("config",t,n),j["delete"](a,n,t).then((function(e){r({status:!0,data:e.data,reponse:e})}))["catch"]((function(e){o({status:!1,error:e.response,code:e.code,stack:e.stack})}))}))},get:function(e,t){var n=this;return new Promise((function(s,r){var o=e.includes("://")?e:n.getBaseUrl()+e;j.get(o,t).then((function(e){s({status:!0,data:e.data,reponse:e})}))["catch"]((function(e){r({status:!1,error:e.response,code:e.code,stack:e.stack})}))}))},postFile:function(e,t){var n=this,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(r,o){n.getBase64(t).then((function(a){var i=new Headers;console.log("headers : ",i);var c=t.name.split("."),l={method:"POST",headers:i,body:JSON.stringify({upload:a.base64,filename:c[0],ext:c[1],id:s}),cache:"default"},u=e.includes("://")?e:n.getBaseUrl()+e;fetch(u,l).then((function(e){e.json().then((function(e){r(e)}))["catch"]((function(e){o(e)}))}))}))}))},getBase64:function(e){return new Promise((function(t,n){var s=new FileReader;s.readAsDataURL(e),s.onloadend=function(){var e=s.result.split(",");t({src:s.result,base64:e[1]})},s.onerror=function(e){return n(e)}}))}},R=S,B=n("0ae9"),E=n("1be5");c.a.use(B["a"]),c.a.use(E["a"]);var P=new c.a,F=Object(a["a"])(Object(a["a"])({},R),{},{$bvToast:P.$bvToast,$bvModal:P.$bvModal,modalMessage:function(e,t){var n=this,s={size:"md",buttonSize:"sm",hideFooter:!0,centered:!0};for(var r in t)s[r]=t[r];return new Promise((function(t,r){n.$bvModal.msgBoxConfirm(e,s).then((function(e){e?t(e):r(e)}))["catch"]((function(e){r(e)}))}))},modalConfirmDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Confirmer la suppression, NB : cette action est irreverssible.",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{title:"Attention",okVariant:"danger",okTitle:"Supprimer",cancelTitle:"Annuler",footerClass:"p-2"};return this.modalMessage(e,t)},modalSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n={title:"Succes",headerBgVariant:"success",bodyClass:["p-3"],hideFooter:!0,headerTextVariant:"light"};for(var s in t)n[s]=t[s];return this.modalMessage(e,n)},notification:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";this.$bvToast.toast(" ",{title:e,variant:t,solid:!0,toaster:"b-toaster-top-right"})},bPost:function(e,t,n){var s=this,r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return new Promise((function(o,a){s.post(e,t,n).then((function(e){r&&s.notification("success"),o(e)}))["catch"]((function(e){s.notification(s.GetErrorTitle(e),"warning"),a(e)}))}))},bGet:function(e,t){var n=this,s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new Promise((function(r,o){n.get(e,t).then((function(e){s&&n.notification("success"),r(e)}))["catch"]((function(e){n.notification(n.GetErrorTitle(e),"warning"),o(e)}))}))},GetErrorTitle:function(e){var t;if(e.code)switch(e.code){case"ECONNABORTED":var n=this.axiosInstance.defaults.timeout/1e3+"s";t="Impossible de joindre l'hote distant, temps impartie epuisé. ("+n+")";break;default:t="Une erreur s'est produite"}else e.error&&e.error.statusText&&(t=decodeURI(e.error.statusText));return t}}),$=F,L={AfterRedirect:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("AfterRedirect action .",e);var s=null;if("redirect"==e&&t);else if("home"==e)window.location.assign("/");else if("reload"==e)window.location.reload(),console.log("reload this page");else if("emit_even"==e){var r=new CustomEvent("login_rx_vuejs__user_is_login");document.dispatchEvent(r)}else"default"==e&&(n.reponse&&n.reponse.config.url!==n.reponse.request.responseURL?window.location.assign(n.reponse.request.responseURL):n.data&&n.data.createuser?s="final-gl-register":n.data&&window.location.reload());return s}},U=new c.a,V=Object(a["a"])(Object(a["a"])({},L),{},{messages:{log_email:"Email ou Nom d'utilisateur",pass:"Mot de passe",login:"Nom d'utilisateur",mail:"Email",submit:{first:"Suivant",connect:"Connexion",register:"S'inscrire",final:"terminée"},devisCreateUser:"Votre compte a été creer sur <a href='/'> lesroisdelareno.fr </a>. <br> <strong> Bien vouloir verifier votre boite mail afin de valider votre compte </strong>"},modalSuccess:function(e,t){return $.modalSuccess(e,t)},msgCreate:function(e){var t=U.$createElement,n=[];for(var s in e)n.push(t("p",{domProps:{innerHTML:e[s]},style:{lineHeight:"25px",fontSize:"17px",padding:"15px 15px 0px",margin:0}},[]));return t("div",{},[n])}}),q=Object(a["a"])(Object(a["a"])({},R),{},{getRandomIntInclusive:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:99,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:999;return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}}),I=q,D=(n("d3b7"),n("e6cf"),{url_session:"/session/token",token:null,getToken:function(){var e=this;return new Promise((function(t){e.token&&t(e.token),console.log(" Config :: ",I.BaseUrl(),"\n this.url_session :: ",e.url_session),I.get(I.BaseUrl()+e.url_session).then((function(n){e.token=n.data,t(n.data)}))}))}}),A=Object(a["a"])(Object(a["a"])({},I),{},{dPost:function(e,t){var n=arguments,s=this;return Object(o["a"])(regeneratorRuntime.mark((function r(){var o,a,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return o=n.length>2&&void 0!==n[2]?n[2]:null,r.next=3,D.getToken();case 3:return a=r.sent,i={"X-CSRF-Token":a,"Content-Type":"application/json"},o&&(i=s.mergeHeaders(o,i)),r.abrupt("return",s.post(e,t,{headers:i}));case 7:case"end":return r.stop()}}),r)})))()},dGet:function(e){var t=arguments,n=this;return Object(o["a"])(regeneratorRuntime.mark((function s(){var r,o,a;return regeneratorRuntime.wrap((function(s){while(1)switch(s.prev=s.next){case 0:return r=t.length>1&&void 0!==t[1]?t[1]:null,s.next=3,D.getToken();case 3:return o=s.sent,a={"X-CSRF-Token":o,"Content-Type":"application/json"},r&&(a=n.mergeHeaders(r,a)),s.abrupt("return",n.get(e,{headers:a}));case 7:case"end":return s.stop()}}),s)})))()},mergeHeaders:function(e,t){if(e)for(var n in e)t[n]=e[n];return t}}),M=A,N=n("7bb1"),H=n("4c93");Object(N["c"])("email",H["b"]),Object(N["c"])("required",Object(a["a"])(Object(a["a"])({},H["d"]),{},{message:"Ce champs est requis"})),Object(N["c"])("alpha",H["a"]),Object(N["c"])("alpha",H["c"]);n("4795");var W={user:{},FB:null,appId:"",scope:"public_profile, email",version:"v11.0",openPopup:function(){var e=this,t=this;window.FB.login((function(t){e.statusChangeCallback(t,!0)}),{scope:t.scope,return_scopes:!0})},logOut:function(){window.FB.logout((function(e){this.onLogOut(e)}))},onLogOut:function(e){console.log("Déconnetion réussi",e)},statusChangeCallback:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.user=e,t){var n=new CustomEvent("wbu-fb-status-change");document.dispatchEvent(n)}console.log("status",this.user)},getUserStatus:function(){var e=this;window.FB.getLoginStatus((function(t){e.statusChangeCallback(t)}))},chargement:function(){var e=this,t=document.getElementsByTagName("head")[0],n=document.createElement("script");t.appendChild(n),n.id="facebook-jssdk-021",n.onload=function(){function t(){window.FB?(e.FB=window.FB,e.FB.init({appId:e.appId,cookie:!0,xfbml:!0,version:e.version,statue:!1}),console.log("Chargement du JS facebook"),e.getUserStatus()):(console.log("facebook not load"),setTimeout((function(){t()}),900))}t()},n.src="https://connect.facebook.net/en_US/sdk.js"}},z=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-center"},[n("a",{staticClass:"content-center__img",attrs:{href:"/"}},[n("img",{staticClass:"img-fluid",attrs:{src:e.urlLogo,alt:""}})]),n("h4",{staticClass:"title"},[e._v("Connectez vous avec")]),n("div",{staticClass:"content-center__btn-column"},[n("logingoogle",{attrs:{idHtml:"default"}}),n("div",{staticClass:"btn-login btn-login--facebook",on:{click:e.loginFacebook}},[n("span",{staticClass:"btn-login__icon icon-facebook"}),n("i",{staticClass:"btn-login__text"},[e._v(" Facebook ")]),"facebook"===e.waiting?n("svgWaiting"):e._e()],1)],1),n("strong",{staticClass:"d-block"},[e._v(" Ou ")]),n("hr",{staticClass:"diviseur"}),n("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.log_email))]),n("div",{staticClass:"form-group content-center__input"},[n("ValidationProvider",{attrs:{name:"name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name[0].value,expression:"form.name[0].value"}],staticClass:"form-control",attrs:{type:"text",name:"name"},domProps:{value:e.form.name[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.name[0],"value",t.target.value)}}}),n("div",{staticClass:"text-danger text-small"},e._l(t.errors,(function(t,s){return n("small",{key:s,staticClass:"d-block"},[e._v(" "+e._s(t)+" ")])})),0)]}}])})],1),n("div",{staticClass:"content-center__btn"},[n("div",{staticClass:"btn-login btn-login--connexion",on:{click:e.checkUserStatus}},[n("span",{staticClass:"btn-login__text"},[e._v(" "+e._s(e.messages.submit.first)+" ")]),"wait"===e.waiting?n("svgWaiting"):e._e()],1)])])},G=[],J=(n("e260"),n("3ca3"),n("ddb0"),function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"buttton-google-aouth",class:e.classRender,attrs:{id:e.idHtmlrender}})}),X=[],K={userAccess:{},client_id:"513247959752-qapd9jb30pdtoh51m0h53070a2v8c4er.apps.googleusercontent.com"};function Q(e){return new Promise((function(t){var n=document.createElement("script");n.setAttribute("src",e),n.onload=function(){console.log(" Chargement du script ok : ",e),t(!0)},document.head.appendChild(n)}))}var Y={name:"logingoogle",props:{idHtml:{type:String,required:!0},returnUidInfo:{type:Boolean,default:!1},classRender:{type:Array,default:function(){return["mx-auto"]}},action_after_login:{type:String,default:"default"}},mounted:function(){var e=this;window.google?this.getUserInfoFromFrame():Q("https://accounts.google.com/gsi/client").then((function(){e.getUserInfoFromFrame()}))},computed:{idHtmlrender:function(){return"google-login-tab"+this.idHtml}},methods:{getUserInfoFromFrame:function(){var e=this;function t(t){console.log("Encoded JWT ID token: ",t),K.userAccess=Object(a["a"])(Object(a["a"])({},t),{},{client_id:t.clientId}),e.TryToLoginWithGoogle(),window.rxGoogle=K}console.log(" window.onload ! ",window.onload);var n=function(){window.google.accounts.id.initialize({client_id:K.client_id,callback:t}),window.google.accounts.id.renderButton(document.getElementById(e.idHtmlrender),{theme:"outline",size:"large"}),window.google.accounts.id.prompt()};n()},TryToLoginWithGoogle:function(){var e=this;return new Promise((function(t,n){M.post("/login-rx-vuejs/google-check",K.userAccess).then((function(n){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-success",e.alertText="Connexion réussie",e.$emit("ev_logingoogle",n.data),e.returnUidInfo||L.AfterRedirect(e.action_after_login,null,n),t(n)}))["catch"]((function(t){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-danger",e.alertText="Google : Erreur de connexion",t.error&&t.error.statusText&&""!=t.error.statusText&&(e.alertText=t.error.statusText),console.log(" Error ajax ",t.error),console.log(" Error ajax ",t.code),console.log(" Error ajax ",t.stack),n(t)}))}))}}},Z=Y,ee=(n("0d95"),Object(m["a"])(Z,J,X,!1,null,null,null)),te=ee.exports,ne={name:"checkstatus",props:{urlLogo:{type:String,required:!0},form:{type:Object,required:!0},formValidate:{type:Object,required:!0}},components:{svgWaiting:function(){return n.e(0).then(n.bind(null,"93ef"))},ValidationProvider:N["b"],logingoogle:te},data:function(){return{messages:V.messages,waiting:""}},methods:{loginFacebook:function(){this.waiting="facebook",W.openPopup()},logOutFacebook:function(){W.logOut()},checkUserStatus:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",n="/login-rx-vuejs/check-user-status",t.next=4,e.formValidate.validate();case 4:s=t.sent,s?M.post(n,e.form).then((function(t){e.waiting="",t.data?e.$emit("select-stepe","setPassword"):e.$emit("select-stepe","register")})):e.waiting="";case 6:case"end":return t.stop()}}),t)})))()}}},se=ne,re=Object(m["a"])(se,z,G,!1,null,null,null),oe=re.exports,ae=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-center"},[n("a",{staticClass:"content-center__img",attrs:{href:"/"}},[n("img",{attrs:{src:e.urlLogo,alt:""}})]),n("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.pass))]),n("div",{staticClass:"form-group content-center__input"},[n("ValidationProvider",{ref:"refPass",attrs:{name:"pass",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.form.password?n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password[0].value,expression:"form.password[0].value"}],staticClass:"form-control",attrs:{type:"password",name:"pass"},domProps:{value:e.form.password[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.password[0],"value",t.target.value)}}}):e._e(),n("div",{staticClass:"text-danger text-small"},e._l(t.errors,(function(t,s){return n("small",{key:s,staticClass:"d-block"},[e._v(" "+e._s(t)+" ")])})),0)]}}])})],1),n("a",{staticClass:"content-center__forgot-pass",attrs:{href:"/user/password"}},[e._v(" Mot de passe oublié ? ")]),n("div",{staticClass:"content-center__btn"},[n("div",{staticClass:"btn-login btn-login--connexion",on:{click:e.Login}},[n("span",{staticClass:"btn-login__text"},[e._v(" "+e._s(e.messages.submit.connect)+" ")]),"wait"==e.waiting?n("svgWaiting"):e._e()],1)]),n("hr"),n("a",{staticClass:"text-center d-block",attrs:{href:"#"},on:{click:function(t){return e.$emit("select-stepe","checkstatus")}}},[e._v(" Retour ")])])},ie=[],ce={name:"checkstatus",props:{urlLogo:{type:String,required:!0},form:{type:Object,required:!0},formValidate:{type:Object,required:!0},action_after_login:{type:String,required:!0}},components:{svgWaiting:function(){return n.e(0).then(n.bind(null,"93ef"))},ValidationProvider:N["b"]},data:function(){return{messages:V.messages,waiting:""}},mounted:function(){void 0===this.form.password&&this.$set(this.form,"password",[{value:""}])},methods:{Login:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",n="/login-rx-vuejs/user-connexion",t.next=4,e.formValidate.validate();case 4:s=t.sent,setTimeout((function(){s?M.post(n,e.form).then((function(t){e.waiting="",V.AfterRedirect(e.action_after_login,null,t)}))["catch"]((function(t){e.$refs.refPass.setErrors([t.error.statusText]),e.waiting="error"})):e.waiting=""}),3e3);case 6:case"end":return t.stop()}}),t)})))()}}},le=ce,ue=Object(m["a"])(le,ae,ie,!1,null,null,null),de=ue.exports,fe=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"content-center"},[n("a",{staticClass:"content-center__img",attrs:{href:"/"}},[n("img",{attrs:{src:e.urlLogo,alt:""}})]),n("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.login))]),n("div",{staticClass:"form-group content-center__input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name[0].value,expression:"form.name[0].value"}],staticClass:"form-control",attrs:{type:"text",readonly:"true",name:"name"},domProps:{value:e.form.name[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.name[0],"value",t.target.value)}}})]),e.showPassword?n("h3",{staticClass:"content-center__title"},[e._v(" "+e._s(e.messages.pass)+" ")]):e._e(),e.showPassword?n("div",{staticClass:"form-group content-center__input"},[e.form.password?n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.password[0].value,expression:"form.password[0].value"}],staticClass:"form-control",attrs:{type:"password",name:"pass"},domProps:{value:e.form.password[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.password[0],"value",t.target.value)}}}):e._e()]):e._e(),n("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.mail))]),n("ValidationProvider",{ref:"mail",staticClass:"d-block w-100",attrs:{name:"mail",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("div",{staticClass:"form-group content-center__input"},[n("input",{directives:[{name:"model",rawName:"v-model",value:e.form.mail[0].value,expression:"form.mail[0].value"}],staticClass:"form-control",attrs:{type:"mail",name:"mail"},domProps:{value:e.form.mail[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.mail[0],"value",t.target.value)}}})]),n("div",{staticClass:"text-danger text-small"},e._l(t.errors,(function(t,s){return n("small",{key:s,staticClass:"d-block"},[e._v(" "+e._s(t)+" ")])})),0)]}}])}),e._l(e.templates,(function(t,s){return n("ValidationProvider",{key:s,ref:t.ref,refInFor:!0,staticClass:"d-block w-100",scopedSlots:e._u([{key:"default",fn:function(s){return[n(t,{tag:"component"}),n("div",{staticClass:"text-danger text-small"},e._l(s.errors,(function(t,s){return n("small",{key:s,staticClass:"d-block"},[e._v(" "+e._s(t)+" ")])})),0)]}}],null,!0)})})),n("div",{staticClass:"content-center__btn"},[n("div",{staticClass:"btn-login btn-login--connexion",on:{click:e.Register}},[n("span",{staticClass:"btn-login__text"},[e._v(" "+e._s(e.messages.submit.register)+" ")]),"wait"==e.waiting?n("svgWaiting"):e._e()],1)]),n("hr"),n("a",{staticClass:"text-center d-block",attrs:{href:"#"},on:{click:function(t){return e.$emit("select-stepe","checkstatus")}}},[e._v(" Retour ")])],2)},me=[],ge=(n("4160"),n("159b"),n("ac1f"),n("1276"),n("d4ec")),pe=n("bee2"),ve=(n("b0c0"),n("a4d3"),n("e01a"),{modelsFields:{},string:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];0===n.length&&n.push({value:""});var s=[];s.push(e("label",{class:["d-block","content-center__title"]},[t.label_value])),n.forEach((function(t){s.push(e("input",{props:{type:"text",value:t.value,b_input:{type:Object,required:!0}},on:{input:function(e){e.target&&e.target.value&&(t.value=e.target.value)}},class:["form-control"]}))})),s.push(e("small",{class:["text-muted"]},[t.description]));var r=e("div",{props:{},class:["form-group","content-center__input"]},s);return r}}),he=function(){function e(t,n){Object(ge["a"])(this,e),this.entity=t,this.bundle=n}return Object(pe["a"])(e,[{key:"format",value:function(){var e=Object(o["a"])(regeneratorRuntime.mark((function e(){var t,n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,this.getFields();case 2:return t=e.sent,e.abrupt("return",new Promise((function(e,s){if(t.data&&t.data.fields){ve.modelsFields=n.buildModel(t.data.fields);var r=[],o=function(e){r.push({ref:e,props:{name:{type:String,default:t.data.fields[e].name}},render:function(n){var s=[];switch(t.data.fields[e].type){case"string":s.push(ve.string(n,t.data.fields[e],ve.modelsFields[e]));break}return n("div",s)}})};for(var a in t.data.fields)o(a);e({templates:r,models:ve.modelsFields})}else s("Aucune donnée disponible")})));case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}()},{key:"getFields",value:function(){var e="/api/form-node/generate-form";return"user"===this.entity&&(e="/api/form-node/generate-user"),e+="/"+this.bundle,M.get(e)}},{key:"buildModel",value:function(e){var t={};for(var n in e)e[n].type&&(t[n]=[]);return t}}]),e}(),we=he,be={name:"checkstatus",props:{urlLogo:{type:String,required:!0},form:{type:Object,required:!0},formValidate:{type:Object,required:!0},showPassword:{type:Boolean,default:!1},action_after_login:{type:String,required:!0}},components:{svgWaiting:function(){return n.e(0).then(n.bind(null,"93ef"))},ValidationProvider:N["b"]},data:function(){return{messages:V.messages,waiting:"",templates:[]}},mounted:function(){this.showPassword?void 0===this.form.password&&this.$set(this.form,"password",[{value:""}]):this.form.password&&delete this.form.password,this.getFields()},methods:{Register:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",n="/user/register?_format=json",t.next=4,e.formValidate.validate();case 4:s=t.sent,s?M.post(n,e.form).then((function(t){console.log("resp : ",t),e.waiting="",V.modalSuccess(V.msgCreate([e.messages.devisCreateUser]),{title:"Votre compte a été crré",footerClass:"d-none",headerBgVariant:"success",headerTextVariant:"light"}).then((function(){V.AfterRedirect(e.action_after_login,t)}))}))["catch"]((function(t){if(e.waiting="",t.error&&t.error.data&&t.error.data.errors){var n=t.error.data.errors;n.forEach((function(t){var n=t.split(":");e.$refs[n[0]]&&(e.$refs[n[0]][0]?e.$refs[n[0]][0].setErrors([n[1]]):e.$refs[n[0]].setErrors([n[1]]))}))}})):e.waiting="";case 6:case"end":return t.stop()}}),t)})))()},getFields:function(){var e=this,t=new we("user","user");t.format().then((function(t){for(var n in e.templates=t.templates,t.models)e.$set(e.form,n,t.models[n]);console.log("resp : ",t)}))}}},_e=be,ke=Object(m["a"])(_e,fe,me,!1,null,null,null),xe=ke.exports,Ce={props:{action_after_login:{type:String,default:"default"}},name:"LoginRegister",components:{ValidationObserver:N["a"]},data:function(){return{messages:V.messages,waiting:"",form:{name:[{value:""}],mail:[{value:""}]},password:"",mail:"",stepe:oe,models:{},baseURl:I.baseURl,isBusy:!1,alertDisplay:!1,alertType:"alert-danger",alertText:"",urlLogo:window.location.origin+""+window.logo_current_theme,formValidate:{}}},mounted:function(){W.appId=889256191665205,this.TryToLoginWithFacebook(),W.chargement(),this.formValidate=this.$refs.formValidate},methods:{selectStepe:function(e){switch(e){case"checkstatus":this.stepe=oe;break;case"setPassword":this.stepe=de;break;case"register":this.stepe=xe;break}},TryToLoginWithFacebook:function(){var e=this;document.addEventListener("wbu-fb-status-change",(function(){e.isBusy=!0,e.getFields(),M.post("/login-rx-vuejs/facebook-check",W.user).then((function(t){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-success",e.alertText=" Connexion réussie  ",t.reponse&&t.reponse.config.url!==t.reponse.request.responseURL?window.location.assign(t.reponse.request.responseURL):t.data&&t.data.createuser?e.stepe="final-fb-register":window.location.assign(window.location.origin)}))["catch"]((function(t){e.isBusy=!1,e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-danger",e.alertText="Facebook : Erreur de connexion ",t.error&&(e.alertText=t.error.statusText)}))}),!1)},IsBusy:function(){this.isBusy=!0,console.log("this.isbusy",this.isBusy)},finalRegister:function(){var e=this;return Object(o["a"])(regeneratorRuntime.mark((function t(){var n,s,r;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",n={},s="","final-gl-register"===e.stepe?(s="/login-rx-vuejs/google-login",n={fields:e.models,google:[]}):"final-fb-register"===e.stepe&&(s="/login-rx-vuejs/facebook-login",n={fields:e.models,facebook:W.user}),t.next=6,e.$refs.formValidate.validate();case 6:r=t.sent,r&&M.post(s,n).then((function(t){console.log(t),e.waiting="",t.reponse&&t.reponse.config.url!==t.reponse.request.responseURL&&window.location.assign(t.reponse.request.responseURL)}));case 8:case"end":return t.stop()}}),t)})))()}}},ye=Ce,je=(n("f073"),Object(m["a"])(ye,s,r,!1,null,null,null));t["default"]=je.exports},aaa3:function(e,t,n){},eeab:function(e,t,n){},f073:function(e,t,n){"use strict";n("eeab")}}]);
//# sourceMappingURL=loginRxVuejs.umd.min.3.js.map