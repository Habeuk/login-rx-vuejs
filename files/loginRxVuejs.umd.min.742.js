"use strict";(("undefined"!==typeof self?self:this)["webpackChunkloginRxVuejs"]=("undefined"!==typeof self?self:this)["webpackChunkloginRxVuejs"]||[]).push([[742],{9742:(e,t,s)=>{s.r(t),s.d(t,{default:()=>he});var n=function(){var e=this,t=e._self._c;return t("ValidationObserver",{ref:"formValidate",attrs:{tag:"form"}},[t("div",{staticClass:"login-page",attrs:{facebook_app_is_define:e.facebook_app_is_define}},[e.alertDisplay?t("div",{staticClass:"alert w-100",class:e.alertType,attrs:{role:"alert"},domProps:{innerHTML:e._s(e.alertText)}}):e._e(),e.isBusy?t("div",{staticClass:"spinner-grow text-primary",staticStyle:{width:"3rem",height:"3rem"},attrs:{role:"status"}},[t("span",{staticClass:"sr-only"},[e._v("Chargement ...")])]):e._e(),t("transition",{attrs:{name:"customslide"}},[t("div",{staticClass:"block-center"},[t(e.stepe,{tag:"component",attrs:{urlLogo:e.urlLogo,formValidate:e.formValidate,"action-after-login":e.actionAfterLogin,"model-register-form":e.modelRegisterForm,"show-password":e.showPassword,"action-after-register":e.actionAfterRegister,"show-modal-success":e.showModalSuccess,configs_login_rx_vuejs:e.configs_login_rx_vuejs,"show-register-link":e.showRegisterLink,"readonly-name":e.readonlyName},on:{"select-stepe":e.selectStepe,"go-register":e.goRegister}})],1)])],1),t("div",{staticClass:"politik-secur mx-auto text-center"},[e._t("condition_utilisation",(function(){return[e.configs_login_rx_vuejs&&e.configs_login_rx_vuejs.texts&&e.configs_login_rx_vuejs.texts.condition_utilisation?t("div",{domProps:{innerHTML:e._s(e.configs_login_rx_vuejs.texts.condition_utilisation.value)}}):e._e()]}))],2)])},o=[],r=s(9199),i=s(5207),a=s(8123),l=(s(4114),s(6099),s(3362),s(9274)),c=s.n(l),u=function(){var e=this,t=e._self._c;return t("div",[t("b-button",{attrs:{variant:"outline-success",size:"sm"},on:{click:e.onSubmit}},[t("span",[e._v(e._s(e.texte))]),e.running?t("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)},d=[];const g={name:"ButtonSave",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Enregistrer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{onSubmit:function(){this.$emit("ev-click")}}},f=g;var m=s(1656),p=(0,m.A)(f,u,d,!1,null,"29246a2e",null);p.exports;var v=function(){var e=this,t=e._self._c;return t("div",[t("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:e.DeleteFile}},[t("span",[e._v(" "+e._s(e.texte)+" ")]),e.running?t("b-icon",{staticClass:"ml-2",attrs:{icon:"arrow-clockwise",animation:"spin-pulse"}}):e._e()],1)],1)},_=[];const h={name:"ButtonDelete",props:{running:{type:Boolean,required:!0},texte:{type:String,default:"Supprimer"}},components:{},data:function(){return{}},mounted:function(){},watch:{},computed:{},methods:{DeleteFile:function(){this.$emit("ev-click")}}},w=h;var x=(0,m.A)(w,v,_,!1,null,"0b82f270",null);x.exports;s(6918),s(4423),s(8598),s(739),s(3288),s(2010),s(3110),s(9432),s(1699),s(2762),s(2207),s(5815),s(4979),s(9739);var b=s(2465),k=b.A.create({timeout:3e5});k.interceptors.request.use((function(e){return e.headers["request-startTime"]=(new Date).getTime(),e})),k.interceptors.response.use((function(e){var t=(new Date).getTime(),s=e.config.headers["request-startTime"],n=t-s;return n&&(n/=1e3),e.headers["request-duration"]=n,e}));var C,y=function(e,t){var s=e+":"+t,n=btoa(s);return"Basic "+n},A=JSON.parse(window.localStorage.getItem("user"));C=window.localStorage.getItem("current_user")?JSON.parse(window.localStorage.getItem("current_user")):null;var T={auth:A?y(A.username,A.password):null,current_user:C,axiosInstance:k,TestDomain:null,baseUrl:null,languageId:null,debug:!1,isLocalDev:!(!window.location.host.includes("localhost")&&!window.location.host.includes(".kksa")),customHeaders:{},getBaseUrl:function(){return this.baseUrl?this.isLocalDev&&this.TestDomain?this.TestDomain.trim("/"):this.baseUrl:this.isLocalDev&&this.TestDomain?this.TestDomain.trim("/"):window.location.protocol+"//"+window.location.host},getStatusText:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e?t?e?e.response&&e.headers.customstatustext?e.headers.customstatustext:void 0:e.statusText?e.statusText:null:e.response&&e.response.headers&&e.response.headers.customstatustext?e.response.headers.customstatustext:e.response&&e.response.statusText?e.response.statusText:null:null},post:function(e,t){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(o,r){""===s.languageId||void 0===s.languageId||null===s.languageId||e.includes("://")||(e="/"+s.languageId+e);var i=e.includes("://")?e:s.getBaseUrl()+e;n=s.mergeCustomHeaders(n),k.post(i,t,n).then((function(e){s.debug&&console.log("Debug axio : \n",i,"\n payload: ",t,"\n config: ",n,"\n Duration : ",e.headers["request-duration"],"\n reponse: ",e,"\n ------ \n"),o({status:!0,data:e.data,reponse:e,statusText:s.getStatusText(e,!0)})}))["catch"]((function(e){console.log("error wbutilities",e.response),r({status:!1,error:e.response,code:e.code,stack:e.stack,statusText:s.getStatusText(e)})}))}))},delete:function(e,t){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise((function(o,r){var i=e.includes("://")?e:s.getBaseUrl()+e;n=s.mergeCustomHeaders(n),k["delete"](i,n,t).then((function(e){o({status:!0,data:e.data,reponse:e,statusText:s.getStatusText(e,!0)})}))["catch"]((function(e){r({status:!1,error:e.response,code:e.code,stack:e.stack,statusText:s.getStatusText(e)})}))}))},get:function(e){var t=this,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,o){""===t.languageId||void 0===t.languageId||null===t.languageId||e.includes("://")||(e="/"+t.languageId+e);var r=e.includes("://")?e:t.getBaseUrl()+e;s=t.mergeCustomHeaders(s),k.get(r,s).then((function(e){t.debug&&console.log("Debug axio : \n",r,"\n Config: ",s,"\n Duration : ",e.headers["request-duration"],"\n Reponse: ",e,"\n ------ \n"),n({status:!0,data:e.data,reponse:e,statusText:t.getStatusText(e,!0)})}))["catch"]((function(e){o({status:!1,error:e.response,code:e.code,stack:e.stack,statusText:t.getStatusText(e)})}))}))},postFile:function(e,t){var s=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return new Promise((function(o,r){s.getBase64(t).then((function(i){var a=new Headers,l=t.name.split("."),c={method:"POST",headers:a,body:JSON.stringify({upload:i.base64,ext:l.pop(),filename:l.join("."),id:n}),cache:"default"},u=e.includes("://")?e:s.getBaseUrl()+e;fetch(u,c).then((function(e){e.json().then((function(e){o(e)}))["catch"]((function(e){r(e)}))}))}))}))},getBase64:function(e){return new Promise((function(t,s){var n=new FileReader;n.readAsDataURL(e),n.onloadend=function(){var e=n.result.split(",");t({src:n.result,base64:e[1]})},n.onerror=function(e){return s(e)}}))},setHeaders:function(e,t){this.customHeaders[e]=t},mergeCustomHeaders:function(e){if(e.headers||(e.headers={}),this.customHeaders)for(var t in this.customHeaders)e.headers[t]=this.customHeaders[t];return e}};const S=T;var R=s(7918),j=s(2788);c().use(R.F),c().use(j.l);var B=new(c()),L=(0,a.A)((0,a.A)({},S),{},{$bvToast:B.$bvToast,$bvModal:B.$bvModal,modalMessage:function(e,t){var s=this,n={size:"md",buttonSize:"sm",hideFooter:!0,centered:!0};for(var o in t)n[o]=t[o];return new Promise((function(t,o){s.$bvModal.msgBoxConfirm(e,n).then((function(e){console.log("value : ",e),t(e)}))["catch"]((function(e){o(e)}))}))},modalConfirmDelete:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Confirmer la suppression, NB : cette action est irreverssible.",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s={title:"Attention",okVariant:"danger",okTitle:"Supprimer",cancelTitle:"Annuler",footerClass:"p-2",headerBgVariant:"danger",headerTextVariant:"light"};for(var n in t)s[n]=t[n];return this.modalMessage(e,s)},modalSuccess:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s={title:"Succes",headerBgVariant:"success",bodyClass:["p-3"],hideFooter:!0,headerTextVariant:"light"};for(var n in t)s[n]=t[n];return this.modalMessage(e,s)},notification:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"success";this.$bvToast.toast(" ",{title:e,variant:t,solid:!0,toaster:"b-toaster-top-right"})},bPost:function(e,t,s){var n=this,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"success",i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"warning";return new Promise((function(a,l){n.post(e,t,s).then((function(e){o&&n.notification(r),a(e)}))["catch"]((function(e){n.notification(n.GetErrorTitle(e),i),l(e)}))}))},bGet:function(e,t){var s=this,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"success",r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"warning";return new Promise((function(i,a){s.get(e,t).then((function(e){n&&s.notification(o),i(e)}))["catch"]((function(e){s.notification(s.GetErrorTitle(e),r),a(e)}))}))},GetErrorTitle:function(e){var t;if(e.code)switch(e.code){case"ECONNABORTED":var s=this.axiosInstance.defaults.timeout/1e3+"s";t="Impossible de joindre l'hote distant, temps impartie epuisé. ("+s+")";break;default:t="Une erreur s'est produite"}else e.error&&e.error.statusText&&(t=decodeURI(e.error.statusText));return t}});const P=L;s(1121),s(6377),s(6028),s(7769),s(3628);const F={AfterRedirect:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"reload",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;console.log("AfterRedirect action .",e);var n=null;if("redirect"==e&&t);else if("home"==e)window.location.assign("/");else if("reload"==e)window.location.reload();else if("emit_even"==e){var o=new CustomEvent("login_rx_vuejs__user_is_login");document.dispatchEvent(o)}else if("emit_even_register"==e){o=new CustomEvent("login_rx_vuejs__user_is_register");document.dispatchEvent(o)}else"default"==e&&(s.reponse&&s.reponse.config.url!==s.reponse.request.responseURL?window.location.assign(s.reponse.request.responseURL):s.data&&s.data.createuser?n="final-gl-register":s.data&&window.location.reload());return n}};var q=(0,a.A)((0,a.A)({},S),{},{languageId:window.drupalSettings&&window.drupalSettings.path&&window.drupalSettings.path.currentLanguage?window.drupalSettings.path.currentLanguage:null,TestDomain:window.location.host.includes("localhost")?"http://habeuk.kksa":window.location.protocol+"//"+window.location.host,getRandomIntInclusive:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:99,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:999;return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}});const I=q,E=(0,a.A)((0,a.A)({},I),{},{url_session:"/session/token",token:null,getToken:function(){var e=this;return new Promise((function(t){e.token&&t(e.token),e.get(e.url_session).then((function(s){e.token=s.data,t(s.data)}))}))}});var U=(0,a.A)((0,a.A)((0,a.A)({},E),I),{},{dPost:function(e,t){var s=arguments,n=this;return(0,i.A)((0,r.A)().mark((function o(){var i,a,l;return(0,r.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return i=s.length>2&&void 0!==s[2]?s[2]:null,o.next=3,n.getToken();case 3:return a=o.sent,l={"X-CSRF-Token":a,"Content-Type":"application/json"},i&&(l=n.mergeHeaders(i,l)),o.abrupt("return",n.post(e,t,{headers:l}));case 7:case"end":return o.stop()}}),o)})))()},dGet:function(e){var t=arguments,s=this;return(0,i.A)((0,r.A)().mark((function n(){var o,i,a;return(0,r.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return o=t.length>1&&void 0!==t[1]?t[1]:null,n.next=3,s.getToken();case 3:return i=n.sent,a={"X-CSRF-Token":i,"Content-Type":"application/json"},o&&(a=s.mergeHeaders(o,a)),n.abrupt("return",s.get(e,{headers:a}));case 7:case"end":return n.stop()}}),n)})))()},mergeHeaders:function(e,t){if(e)for(var s in e)t[s]=e[s];return t}});const D=U;var V=new(c());const $=(0,a.A)((0,a.A)({},F),{},{messages:{title_login:"Connect with",log_email:"Email ou Nom d'utilisateur",email:"Your email address",pass:"Mot de passe",login:"Nom d'utilisateur",mail:"Email",title_end:"Don't have an account?",create_compte:"Register",forget_pass:"Forgotten password",submit:{first:"Suivant",connect:"Connexion",register:"S'inscrire",final:"terminée"},back:"Back",info_about_register:"Your login information will be transferred to this address",title_register_auto:"Automatic account creation",titre_create_compte:"Your account has been created",devis_create_user:"Votre compte a été creer sur <a href='/'> lesroisdelareno.fr </a>. <br> <strong> Bien vouloir verifier votre boite mail afin de valider votre compte </strong>"},modalSuccess:function(e,t){return P.modalSuccess(e,t)},msgCreate:function(e){var t=V.$createElement,s=[];for(var n in e)s.push(t("p",{domProps:{innerHTML:e[n]},style:{lineHeight:"25px",fontSize:"17px",padding:"15px 15px 0px",margin:0}},[]));return t("div",{},[s])},connexionUser:function(e,t){var s=this;return new Promise((function(n,o){var r="/login-rx-vuejs/user-connexion";D.post(r,e).then((function(e){s.AfterRedirect(t,null,e),n(e)}))["catch"]((function(e){o(e)}))}))}});s(6031);const H={user:{},FB:null,appId:"",scope:"public_profile, email",version:"v11.0",openPopup:function(){var e=this,t=this;window.FB.login((function(t){e.statusChangeCallback(t,!0)}),{scope:t.scope,return_scopes:!0})},logOut:function(){window.FB.logout((function(e){this.onLogOut(e)}))},onLogOut:function(e){console.log("Déconnetion réussi",e)},statusChangeCallback:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.user=e,t){var s=new CustomEvent("wbu-fb-status-change");document.dispatchEvent(s)}console.log("status",this.user)},getUserStatus:function(){var e=this;window.FB.getLoginStatus((function(t){e.statusChangeCallback(t)}))},chargement:function(){var e=this,t=document.getElementsByTagName("head")[0],s=document.createElement("script");t.appendChild(s),s.id="facebook-jssdk-021",s.onload=function(){function t(){window.FB?(e.FB=window.FB,e.FB.init({appId:e.appId,cookie:!0,xfbml:!0,version:e.version,statue:!1}),console.log("Chargement du JS facebook"),e.getUserStatus()):(console.log("facebook not load"),setTimeout((function(){t()}),900))}t()},s.src="https://connect.facebook.net/en_US/sdk.js"}};var N=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content-center"},[t("a",{staticClass:"content-center__img",attrs:{href:"/"}},[t("img",{staticClass:"img-fluid",attrs:{src:e.urlLogo,alt:""}})]),t("h4",{staticClass:"title"},[e._v(e._s(e.messages.title_login))]),t("div",{staticClass:"content-center__btn-column"},[t("logingoogle",{attrs:{idHtml:"default","action-after-login":e.actionAfterLogin}}),t("div",{staticClass:"btn-login btn-login--facebook",on:{click:e.loginFacebook}},[t("span",{staticClass:"btn-login__icon icon-facebook"}),t("i",{staticClass:"btn-login__text"},[e._v(" Facebook ")]),"facebook"===e.waiting?t("svgWaiting"):e._e()],1)],1),t("strong",{staticClass:"d-block"},[e._v(" Ou ")]),t("hr",{staticClass:"diviseur"}),t("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.log_email))]),t("div",{staticClass:"form-group content-center__input"},[t("ValidationProvider",{attrs:{name:"name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name[0].value,expression:"form.name[0].value"}],staticClass:"form-control",attrs:{type:"text",name:"name"},domProps:{value:e.form.name[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.name[0],"value",t.target.value)}}}),t("div",{staticClass:"text-danger text-small"},e._l(s.errors,(function(s,n){return t("small",{key:n,staticClass:"d-block"},[e._v(" "+e._s(s)+" ")])})),0)]}}])})],1),t("div",{staticClass:"content-center__btn"},[t("div",{staticClass:"btn-login btn-login--connexion",on:{click:e.checkUserStatus}},[t("span",{staticClass:"btn-login__text"},[e._v(" "+e._s(e.messages.submit.first)+" ")]),"wait"===e.waiting?t("svgWaiting"):e._e()],1)]),e.showRegisterLink?t("div",[t("hr",{staticClass:"diviseur"}),t("small",[e._v(" "+e._s(e.messages.title_end)+" ")]),t("a",{staticClass:"text-center d-block cursor",attrs:{hre:"#"},on:{click:function(t){return t.preventDefault(),e.register.apply(null,arguments)}}},[e._v(" "+e._s(e.messages.create_compte)+" ")]),t("div",[t("small",[t("a",{attrs:{href:"/user/password"}},[e._v(" "+e._s(e.messages.forget_pass)+" ")])])])]):e._e()])},M=[],O=(s(3792),s(7764),s(2953),function(){var e=this,t=e._self._c;return t("div",{staticClass:"buttton-google-aouth",class:e.classRender,attrs:{id:e.idHtmlrender,client_google_is_define:e.client_google_is_define}})}),G=[];const W={userAccess:{},client_id:"513247959752-qapd9jb30pdtoh51m0h53070a2v8c4er.apps.googleusercontent.com"};var z=s(5353);function J(e){return new Promise((function(t){var s=document.createElement("script");s.setAttribute("src",e),s.onload=function(){console.log(" Chargement du script ok : ",e),t(!0)},document.head.appendChild(s)}))}const Y={name:"LoginGoogle",props:{idHtml:{type:String,required:!0},returnUidInfo:{type:Boolean,default:!1},classRender:{type:Array,default:function(){return["mx-auto"]}},actionAfterLogin:{type:String,required:!0}},computed:(0,a.A)((0,a.A)({},(0,z.aH)(["configs_login_rx_vuejs"])),{},{idHtmlrender:function(){return"google-login-tab"+this.idHtml},client_google_is_define:function(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.client_google_id?(this.initGoogle(),!0):(console.log("Error de configuration de google, veillez denifir la clée 'client_google_id'"),"")}}),methods:{initGoogle:function(){var e=this;window.google?this.getUserInfoFromFrame():J("https://accounts.google.com/gsi/client").then((function(){e.getUserInfoFromFrame()}))},getUserInfoFromFrame:function(){var e=this,t=this;function s(e){W.userAccess=(0,a.A)((0,a.A)({},e),{},{client_id:e.clientId}),t.TryToLoginWithGoogle(),window.rxGoogle=W}var n=function(){var n={client_id:e.configs_login_rx_vuejs.client_google_id,callback:s},o={theme:"outline",size:"large",shape:"rectangular"};D.languageId&&(n.locale=D.languageId,o.locale=D.languageId),window.google.accounts.id.initialize(n),window.google.accounts.id.renderButton(document.getElementById(t.idHtmlrender),o),window.google.accounts.id.prompt()};n()},TryToLoginWithGoogle:function(){var e=this;return new Promise((function(t,s){D.post("/login-rx-vuejs/google-check",W.userAccess).then((function(s){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-success",e.alertText="Connexion réussie",e.$emit("ev_logingoogle",s.data),e.returnUidInfo||F.AfterRedirect(e.actionAfterLogin,null,s),t(s)}))["catch"]((function(t){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-danger",e.alertText="Google : Erreur de connexion",t.error&&t.error.statusText&&""!=t.error.statusText&&(e.alertText=t.error.statusText),console.log(" Error ajax ",t.error),console.log(" Error ajax ",t.code),console.log(" Error ajax ",t.stack),s(t)}))}))}}},X=Y;var K=(0,m.A)(X,O,G,!1,null,null,null);const Q=K.exports,Z={name:"CheckStatus",components:{svgWaiting:function(){return s.e(887).then(s.bind(s,3887))},logingoogle:Q},props:{urlLogo:{type:String,required:!0},formValidate:{type:Object,required:!0},actionAfterLogin:{type:String,required:!0},showRegisterLink:{type:Boolean,default:!1}},data:function(){return{waiting:""}},computed:(0,a.A)((0,a.A)({},(0,z.aH)(["form","configs_login_rx_vuejs"])),{},{messages:function(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.texts?this.configs_login_rx_vuejs.texts:$.messages}}),methods:{loginFacebook:function(){this.waiting="facebook",H.openPopup()},logOutFacebook:function(){H.logOut()},register:function(){this.$emit("go-register")},checkUserStatus:function(){var e=this;return(0,i.A)((0,r.A)().mark((function t(){var s,n;return(0,r.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",s="/login-rx-vuejs/check-user-status",t.next=4,e.formValidate.validate();case 4:n=t.sent,n?D.post(s,e.form).then((function(t){e.waiting="",t.data?e.$emit("select-stepe","setPassword"):e.$emit("select-stepe","register")})):e.waiting="";case 6:case"end":return t.stop()}}),t)})))()}}},ee=Z;var te=(0,m.A)(ee,N,M,!1,null,null,null);const se=te.exports;var ne=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content-center"},[t("a",{staticClass:"content-center__img",attrs:{href:"/"}},[t("img",{attrs:{src:e.urlLogo,alt:""}})]),t("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.pass))]),t("div",{staticClass:"form-group content-center__input"},[t("ValidationProvider",{ref:"refPass",attrs:{name:"pass",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){return[e.form.pass?t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.pass[0].value,expression:"form.pass[0].value"}],staticClass:"form-control",attrs:{type:"password",name:"pass"},domProps:{value:e.form.pass[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.pass[0],"value",t.target.value)}}}):e._e(),t("div",{staticClass:"text-danger text-small"},e._l(s.errors,(function(s,n){return t("small",{key:n,staticClass:"d-block"},[e._v(" "+e._s(s)+" ")])})),0)]}}])})],1),t("a",{staticClass:"content-center__forgot-pass",attrs:{href:"/user/password"}},[e._v(" "+e._s(e.messages.forget_pass)+" ")]),t("div",{staticClass:"content-center__btn"},[t("div",{staticClass:"btn-login btn-login--connexion",on:{click:e.Login}},[t("span",{staticClass:"btn-login__text"},[e._v(" "+e._s(e.messages.submit.connect)+" ")]),"wait"==e.waiting?t("svgWaiting"):e._e()],1)]),t("hr"),t("a",{staticClass:"text-center d-block",attrs:{href:"#"},on:{click:function(t){return e.$emit("select-stepe","checkstatus")}}},[e._v(" "+e._s(e.messages.back)+" ")])])},oe=[];const re={name:"SetPassword",components:{svgWaiting:function(){return s.e(887).then(s.bind(s,3887))}},props:{urlLogo:{type:String,required:!0},formValidate:{type:Object,required:!0},actionAfterLogin:{type:String,required:!0}},data:function(){return{waiting:""}},computed:(0,a.A)((0,a.A)({},(0,z.aH)(["form","configs_login_rx_vuejs"])),{},{messages:function(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.texts?this.configs_login_rx_vuejs.texts:$.messages}}),mounted:function(){void 0===this.form.pass&&this.$set(this.form,"pass",[{value:""}])},methods:{Login:function(){var e=this;return(0,i.A)((0,r.A)().mark((function t(){var s;return(0,r.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",t.next=3,e.formValidate.validate();case 3:s=t.sent,setTimeout((function(){s?$.connexionUser(e.form,e.actionAfterLogin).then((function(){e.waiting=""}))["catch"]((function(t){console.log("Login : ",t),e.$refs.refPass.setErrors([t.error.statusText]),e.waiting="error"})):e.waiting=""}),3e3);case 5:case"end":return t.stop()}}),t)})))()}}},ie=re;var ae=(0,m.A)(ie,ne,oe,!1,null,null,null);const le=ae.exports;var ce=function(){var e=this,t=e._self._c;return t("div",{staticClass:"content-center"},[t("a",{staticClass:"content-center__img",attrs:{href:"/"}},[t("img",{attrs:{src:e.urlLogo,alt:""}})]),"default"===e.modelRegisterFormResult?t("div",[t("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.login))]),t("div",{staticClass:"form-group content-center__input"},[t("ValidationProvider",{attrs:{name:"name",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.name[0].value,expression:"form.name[0].value"}],staticClass:"form-control",attrs:{type:"text",readonly:e.readonlyName,name:"name"},domProps:{value:e.form.name[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.name[0],"value",t.target.value)}}}),t("div",{staticClass:"text-danger text-small"},e._l(s.errors,(function(s,n){return t("small",{key:n,staticClass:"d-block"},[e._v(" "+e._s(s)+" ")])})),0)]}}],null,!1,3793439729)})],1),e.showPassword?t("h3",{staticClass:"content-center__title"},[e._v(" "+e._s(e.messages.pass)+" ")]):e._e(),e.showPassword?t("div",{staticClass:"form-group content-center__input"},[t("ValidationProvider",{attrs:{name:"pass",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){return[e.form.pass?t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.pass[0].value,expression:"form.pass[0].value"}],staticClass:"form-control",attrs:{type:"password",name:"pass"},domProps:{value:e.form.pass[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.pass[0],"value",t.target.value)}}}):e._e(),t("div",{staticClass:"text-danger text-small"},e._l(s.errors,(function(s,n){return t("small",{key:n,staticClass:"d-block"},[e._v(" "+e._s(s)+" ")])})),0)]}}],null,!1,2464977794)})],1):e._e(),t("h3",{staticClass:"content-center__title"},[e._v(e._s(e.messages.mail))]),t("ValidationProvider",{ref:"mail",staticClass:"d-block w-100",attrs:{name:"mail",rules:"required|email"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"form-group content-center__input"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.mail[0].value,expression:"form.mail[0].value"}],staticClass:"form-control",attrs:{type:"mail",name:"mail"},domProps:{value:e.form.mail[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.mail[0],"value",t.target.value)}}})]),t("div",{staticClass:"text-danger text-small"},e._l(s.errors,(function(s,n){return t("small",{key:n,staticClass:"d-block"},[e._v(" "+e._s(s)+" ")])})),0)]}}],null,!1,2930674861)}),t("div",{staticClass:"content-center__btn"},[t("div",{staticClass:"btn-login btn-login--connexion",on:{click:e.RegisterDefault}},[t("span",{staticClass:"btn-login__text"},[e._v(" "+e._s(e.messages.submit.register)+" ")]),"wait"==e.waiting?t("svgWaiting"):e._e()],1)]),t("hr")],1):e._e(),"generate_password"===e.modelRegisterFormResult?t("div",[t("h4",{staticClass:"title mb-5"},[e._v(e._s(e.messages.title_register_auto))]),e.validEmail(e.form.name[0].value)?t("div",{staticClass:"mb-5"},[t("p",[e._v(e._s(e.messages.info_about_register))]),t("strong",[e._v(" "+e._s(e.form.name[0].value)+" ")]),e._v(" "+e._s(e.set_email())+" ")]):e._e(),e.validEmail(e.form.name[0].value)?e._e():t("div",[t("ValidationProvider",{ref:"mail",staticClass:"d-block w-100",attrs:{name:"mail",rules:"required"},scopedSlots:e._u([{key:"default",fn:function(s){return[t("div",{staticClass:"form-group content-center__input"},[t("label",{staticClass:"mb-0 pb-0"},[e._v(" "+e._s(e.messages.email)+" ")]),t("input",{directives:[{name:"model",rawName:"v-model",value:e.form.mail[0].value,expression:"form.mail[0].value"}],staticClass:"form-control",attrs:{type:"mail",name:"mail"},domProps:{value:e.form.mail[0].value},on:{input:function(t){t.target.composing||e.$set(e.form.mail[0],"value",t.target.value)}}}),t("div",[t("small",[e._v(" "+e._s(e.messages.info_about_register)+" ")])])]),t("div",{staticClass:"text-danger text-small"},e._l(s.errors,(function(s,n){return t("small",{key:n,staticClass:"d-block"},[e._v(" "+e._s(s)+" ")])})),0)]}}],null,!1,153872645)})],1),t("div",{staticClass:"content-center__btn"},[t("div",{staticClass:"btn-login btn-login--connexion",on:{click:e.generatePassword}},[t("span",{staticClass:"btn-login__text"},[e._v(" "+e._s(e.messages.submit.register)+" ")]),"wait"==e.waiting?t("svgWaiting"):e._e()],1)])]):e._e(),t("b-alert",{attrs:{dismissible:"",variant:"danger",fade:"",show:!!e.error.message},on:{dismissed:function(t){e.error.message=!1}}},[e._v(" "+e._s(e.error.message)+" ")]),t("a",{staticClass:"text-center d-block",attrs:{href:"#"},on:{click:function(t){return e.$emit("select-stepe","checkstatus")}}},[e._v(" "+e._s(e.messages.back)+" ")])],1)},ue=[];s(1629),s(7495),s(906),s(3500);const de={name:"RegisTer",components:{svgWaiting:function(){return s.e(887).then(s.bind(s,3887))}},props:{urlLogo:{type:String,required:!0},formValidate:{type:Object,required:!0},showPassword:{type:Boolean,default:!1},actionAfterRegister:{type:String,required:!0},modelRegisterForm:{type:[String,Boolean],required:!0},showModalSuccess:{type:Boolean,required:!0},readonlyName:{type:Boolean,default:!0}},data:function(){return{waiting:"",error:{message:!1}}},computed:(0,a.A)((0,a.A)({},(0,z.aH)(["form","configs_login_rx_vuejs"])),{},{messages:function(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.texts?this.configs_login_rx_vuejs.texts:$.messages},modelRegisterFormResult:function(){return"generate_password"==this.modelRegisterForm||"default"==this.modelRegisterForm?this.modelRegisterForm:this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.generate_user?"generate_password":"default"}}),mounted:function(){this.showPassword?void 0===this.form.pass&&this.$set(this.form,"pass",[{value:""}]):this.form.pass&&delete this.form.pass},methods:{generatePassword:function(){var e=this;return(0,i.A)((0,r.A)().mark((function t(){var s,n;return(0,r.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",s="/login-rx-vuejs/genrate-password",t.next=4,e.formValidate.validate();case 4:n=t.sent,n?D.post(s,e.form).then((function(t){console.log("resp : ",t),e.waiting="",$.AfterRedirect(e.actionAfterRegister,null,t)}))["catch"]((function(){e.waiting=""})):(e.waiting="",console.log("echec de validation de mail"));case 6:case"end":return t.stop()}}),t)})))()},RegisterDefault:function(){var e=this;return(0,i.A)((0,r.A)().mark((function t(){var s,n;return(0,r.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",s="/user/register?_format=json",t.next=4,e.formValidate.validate();case 4:n=t.sent,n?D.post(s,e.form).then((function(t){e.waiting="",e.showModalSuccess?$.modalSuccess($.msgCreate([e.messages.devis_create_user.value?e.messages.devis_create_user.value:e.messages.devis_create_user]),{title:e.messages.titre_create_compte,footerClass:"d-none",headerBgVariant:"success",headerTextVariant:"light"}).then((function(){$.AfterRedirect(e.actionAfterRegister,null,t)})):$.AfterRedirect(e.actionAfterRegister,null,t)}))["catch"]((function(t){if(e.waiting="",console.log("catch : ",t),t.error.data&&t.error.data.message&&(e.error.message=t.error.data.message),t.error&&t.error.data&&t.error.data.errors){var s=t.error.data.errors;s.forEach((function(t){var s=t.split(":");e.$refs[s[0]]&&(e.$refs[s[0]][0]?e.$refs[s[0]][0].setErrors([s[1]]):e.$refs[s[0]].setErrors([s[1]]))}))}})):e.waiting="";case 6:case"end":return t.stop()}}),t)})))()},validEmail:function(e){var t=/\S+@\S+\.\S+/;return t.test(e)},set_email:function(){this.form.mail=this.form.name}}},ge=de;var fe=(0,m.A)(ge,ce,ue,!1,null,null,null);const me=fe.exports,pe={name:"LoginRegister",props:{actionAfterLogin:{type:String,default:"default"},actionAfterRegister:{type:String,default:"default"},modelRegisterForm:{type:[String,Boolean],default:!1},showPassword:{type:Boolean,default:!0},showModalSuccess:{type:Boolean,default:!0},showRegisterLink:{type:Boolean,default:!0}},data:function(){return{messages:$.messages,waiting:"",stepe:se,models:{},baseURl:I.baseURl,isBusy:!1,alertDisplay:!1,alertType:"alert-danger",alertText:"",urlLogo:window.location.origin+""+window.logo_current_theme,formValidate:{},readonlyName:!0}},computed:(0,a.A)((0,a.A)({},(0,z.aH)(["configs_login_rx_vuejs"])),{},{facebook_app_is_define:function(){return this.configs_login_rx_vuejs&&this.configs_login_rx_vuejs.facebook_app_id?(this.initFacebook(),!0):""}}),mounted:function(){this.formValidate=this.$refs.formValidate,this.getConfigs()},methods:{initFacebook:function(){H.appId=this.configs_login_rx_vuejs.facebook_app_id,this.TryToLoginWithFacebook(),H.chargement()},selectStepe:function(e){switch(this.readonlyName=!0,e){case"checkstatus":this.stepe=se;break;case"setPassword":this.stepe=le;break;case"register":this.stepe=me;break}},goRegister:function(){this.readonlyName=!1,this.stepe=me},TryToLoginWithFacebook:function(){var e=this;document.addEventListener("wbu-fb-status-change",(function(){e.isBusy=!0,e.getFields(),D.post("/login-rx-vuejs/facebook-check",H.user).then((function(t){e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-success",e.alertText=" Connexion réussie  ",t.reponse&&t.reponse.config.url!==t.reponse.request.responseURL?window.location.assign(t.reponse.request.responseURL):t.data&&t.data.createuser?e.stepe="final-fb-register":window.location.assign(window.location.origin)}))["catch"]((function(t){e.isBusy=!1,e.isBusy=!1,e.alertDisplay=!0,e.alertType="alert-danger",e.alertText="Facebook : Erreur de connexion ",t.error&&(e.alertText=t.error.statusText)}))}),!1)},IsBusy:function(){this.isBusy=!0,console.log("this.isbusy",this.isBusy)},finalRegister:function(){var e=this;return(0,i.A)((0,r.A)().mark((function t(){var s,n,o;return(0,r.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.waiting="wait",s={},n="","final-gl-register"===e.stepe?(n="/login-rx-vuejs/google-login",s={fields:e.models,google:[]}):"final-fb-register"===e.stepe&&(n="/login-rx-vuejs/facebook-login",s={fields:e.models,facebook:H.user}),t.next=6,e.$refs.formValidate.validate();case 6:o=t.sent,o&&D.post(n,s).then((function(t){console.log(t),e.waiting="",t.reponse&&t.reponse.config.url!==t.reponse.request.responseURL&&window.location.assign(t.reponse.request.responseURL)}));case 8:case"end":return t.stop()}}),t)})))()},connexionUser:function(e){return $.connexionUser(e,this.actionAfterLogin)},getConfigs:function(){var e=this,t="/login-rx-vuejs/get-configs";D.post(t,this.form).then((function(t){console.log(" resp.data : ",t.data),e.$store.state.configs_login_rx_vuejs=t.data}))["catch"]((function(e){console.log(e)}))}}},ve=pe;var _e=(0,m.A)(ve,n,o,!1,null,null,null);const he=_e.exports}}]);
//# sourceMappingURL=loginRxVuejs.umd.min.742.js.map